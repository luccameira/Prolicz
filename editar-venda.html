<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <title>Editar Pedido</title>
  <link rel="stylesheet" href="layout.css" />
  <link rel="stylesheet" href="editar-venda.css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
  <script defer src="incluir-layout.js"></script>
</head>
<body>
  <div class="topbar"></div>
  <div class="sidebar"></div>

  <div class="main-content">
    <h1>Editar Pedido</h1>
    <a href="vendas.html" class="btn-voltar">Voltar</a>

    <form id="form-editar-pedido">
      <div id="produtos"></div>
      <button type="button" id="adicionar-produto" class="btn">Adicionar outro produto</button>

      <div id="valor-total-previsto" class="valor-total-previsto">
        Valor total previsto do pedido: <span id="valor-total">R$ 0,00</span>
      </div>

      <button type="button" id="btn-adicionar-observacao" class="btn">Adicionar Observação</button>

      <div id="observacao-bloco" style="display: none;">
        <button type="button" class="btn-fechar" id="btn-fechar-observacao">×</button>

        <div class="form-group">
          <label for="setor-observacao">Setor</label>
          <select id="setor-observacao" multiple="multiple" style="width: 100%;">
            <option value="Todos">Todos</option>
            <option value="Portaria">Portaria</option>
            <option value="Carga e Descarga">Carga e Descarga</option>
            <option value="Conferência de Peso">Conferência de Peso</option>
            <option value="Financeiro">Financeiro</option>
            <option value="Emissão de NF">Emissão de NF</option>
          </select>
        </div>

        <div class="form-group">
          <label for="texto-observacao">Observação</label>
          <textarea id="texto-observacao" style="width: 100%;" rows="4"></textarea>
        </div>

        <button type="button" id="btn-confirmar-observacao" class="btn btn-azul">Confirmar Observação</button>
      </div>

      <div class="observacoes-lista" style="margin-top: 20px;">
        <div id="observacoes-comuns"></div>
        <div id="resets-confirmados"></div>
      </div>

      <button type="button" id="btn-resetar-tarefa" class="btn">Corrigir Tarefa</button>
      <button type="submit" class="btn btn-azul">Salvar Alterações</button>
    </form>
  </div>

  <div id="modal-resetar-tarefa" class="modal-overlay" style="display:none;">
    <div class="modal-box">
      <h2>Corrigir Tarefa</h2>
      <p id="etapa-atual-exibida" style="margin-top: 10px; margin-bottom: 15px;">
        <strong>Etapa atual da tarefa:</strong> <span id="nome-etapa-atual">--</span>
      </p>

      <label for="setor-resetar">Para qual etapa você deseja reenviar esta tarefa para correção?</label>
      <select id="setor-resetar" required>
        <option value="">Selecione a etapa</option>
        <option value="Portaria">Portaria</option>
        <option value="Carga e Descarga">Carga e Descarga</option>
        <option value="Conferência de Peso">Conferência de Peso</option>
        <option value="Financeiro">Financeiro</option>
        <option value="Emissão de NF">Emissão de NF</option>
      </select>

      <label for="motivo-reset">Justifique a necessidade de correção:</label>
      <textarea id="motivo-reset" rows="4" required></textarea>

      <div class="modal-botoes">
        <button id="btn-confirmar-reset" class="btn btn-azul">Confirmar</button>
        <button id="btn-cancelar-reset" class="btn">Cancelar</button>
      </div>
    </div>
  </div>

  <!-- Scripts -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
  <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/pt.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.mask/1.14.16/jquery.mask.min.js"></script>
  <script>
    $(document).ready(function () {
      $('#setor-observacao').select2({
        placeholder: "Selecione os setores",
        width: 'resolve'
      });
    });
  </script>
  <script src="editar-venda.js"></script>
</body>
</html>
